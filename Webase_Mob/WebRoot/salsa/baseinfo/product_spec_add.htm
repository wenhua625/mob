<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>产品特价设定</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<link href="css/style011.css" rel="stylesheet" type="text/css">
<SCRIPT LANGUAGE="JavaScript" src="inc/check.js"></SCRIPT>
<script type="text/javascript" src="js/dojo/dojo.js"></script>
<script type="text/javascript">
    dojo.require("dojo.io.*");
</script>
<script type="text/javascript">
 function work(){
    var formObj = dojo.byId("selectForm");
     dojo.io.bind({
                formNode:formObj,
                url:"work?proname=IN0S07",
                method:formObj.method,
                load:function(type , data ,evt){
                    if(data == "ok"){
                    	alert("操作成功!");
                    	window.opener.location.reload();
                    	window.close();
                    }else{
                    	alert(data);
                    }
                },
                error:function(type,error){
                    alert(type);
                }
		
            })
        }
</script>
<script lanuage="javascript">
 function checkInput()
 {
     checkAll();
     if(isNaN(selectForm.SPEC_PRICE.value))
	 {
	    alert("请输入合法的特价！");
		selectForm.SPEC_PRICE.focus();
		return false;
	 }
	 if(selectForm.CHECKAGENT.length == 0 || selectForm.SPEC_PRICE.value.length == 0 || parseInt(selectForm.SPEC_PRICE.value) == 0)
	 {
	    if(confirm('特价设定没有成功，你不设特价了吗？'))
		{
		   
		   return true;
		}else
		{
		   return false;
		}
	 }
	 work();
 }
 function checkAll()
   {
      for (i=0;i<selectForm.CHECKAGENT.length;i++)
	  {
	     selectForm.CHECKAGENT.options[i].selected = true;
	  }
   }
  function addItem(fromName,toName){
       eval("var obj1=selectForm."+fromName);
       eval("var obj2=selectForm."+toName);
       var na;
       if(obj1.selectedIndex == -1)
        return false;

	for (i = 0; i < obj1.length; i++) {
  		na = obj1.options[i];
  		
  		if (na.selected) {
    		  obj2.add(new Option(na.text,na.value));
    		  obj1.options.remove(i);
  			}
	 }
	 
	 
	for (j = 0;j < obj2.length; j++)
	{ 
		obj2.options[j].selected = true;
		
	}
}
function delItem(fromName,toName){
       eval("var obj1=selectForm."+fromName);
       eval("var obj2=selectForm."+toName);
       var na;
       if(obj1.selectedIndex == -1)
        return false;

	for (i = 0; i < obj1.length; i++) {
  		na = obj1.options[i];
  		
  		if (na.selected) {
    		  obj2.add(new Option(na.text,na.value));
    		  obj1.options.remove(i);
  			}
	 }
	 
	 
	for (j = 0;j < obj1.length; j++)
	{ 
		obj1.options[j].selected = true;
		
	}
}
</script>
</head>

<body>
<form name="selectForm" method="post" action=""  id="selectForm" >
  <table width="100%" height="0" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td align="center" ><b> 产品特价设置</b></td>
    </tr>
    <tr> 
      <td> 
        <table width="100%" border="0" align="center" cellpadding="2" cellspacing="1">
          <tr> 
            <td width="22%" align="right">货号：</td>
            <td colspan="4">!!MJ0S33,01
              <input type="hidden" name="PRODUCT_CODE" value="!!MJ0S33,01">
            </td>
          </tr>
          <tr> 
            <td width="22%" align="right">品名：</td>
            <td colspan="4">!!MJ0S33,03</td>
          </tr>
          <tr> 
            <td valign="top" width="22%" align="right">所有客户：</td>
            <td width="17%"> 
              <select name="ALLAGENT" size="20" multiple id="add" >
                <option>$$XL0021,</option>
              </select>
            </td>
            <td width="5%"> 
              <p> 
                <input type="button" name="Submit3" value="--&gt;&gt;" onClick="addItem('ALLAGENT','CHECKAGENT')">
              </p>
              <p> 
                <input type="button" name="Submit4" value="&lt;&lt;--" onClick="delItem('CHECKAGENT','ALLAGENT')">
              </p>
            </td>
            <td valign="top" width="16%" align="right">要定特价的客户：</td>
            <td width="40%"> 
              <select name="CHECKAGENT" size="20" multiple id="del" >
                <option>$$XL0020,</option>
              </select>
            </td>
          </tr>
          <tr> 
            <td valign="top" width="22%" align="right">特价：</td>
            <td colspan="4"> 
              <input type="text" name="SPEC_PRICE" value="!!MJ0S50,01" maxlength="10" size="10" style ="color:#FF0000">
            </td>
          </tr>
          <tr> 
            <td valign="top" width="22%" align="right">出厂价：</td>
            <td width="17%">!!MJ0S33,10</td>
            <td width="5%">&nbsp;</td>
            <td valign="top" width="16%" align="right">代理价：</td>
            <td width="40%">!!MJ0S33,18</td>
          </tr>
          <tr> 
            <td valign="top" width="22%" align="right">零售价：</td>
            <td width="17%">!!MJ0S33,19</td>
            <td width="5%">&nbsp;</td>
            <td valign="top" width="16%" align="right">百货价：</td>
            <td width="40%">!!MJ0S33,20</td>
          </tr>
         
        </table>
      </td>
    </tr>
  </table>
  
  
  <table width="90%" height="40" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr> 
      <td height="30" valign="bottom"><div align="center"> 
          <input name="Submit" type="button" class="ImgButton" value="设定" onClick="return checkInput()">
          &nbsp;&nbsp;&nbsp;&nbsp; </div>
      </td>
    </tr>
  </table>
</form>
</body>

</html>
